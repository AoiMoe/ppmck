ppmck release 9a ex5.3 by BKC

**** このファイルについて

　ppmck release9aを改変したものです。

　ppmckの機能と以下の機能が利用可能です。

・NSF再生時の過負荷の検出と抑制
・定義データのバンク切り替え
・スラー機能(トラックABC & N106 & VRC6 & VRC7 & MMC5)
・発音時のトリガー発生を若干抑える機能(トラックABC)
・ポルタメント(トラックABC)
・ハードウェアエンベロープ機能（トラックABF & ノイズ & MMC5 ）

**** 過負荷検出

#OVERLOAD_DETECTを使用することで過負荷検出が可能になります。
演奏が発音状態のまま停止され、ビープ音が断続的に出力されます。

過負荷検出を使用しない場合は過負荷状態が発生した場合、
演奏が全トラック1フレーム以上遅れます。


**** 定義データのバンク切り替え
　定義データが一定以上ある場合、定義データ用に新しいバンクを用意します。
自動的にサイズを計算し、ボリュームエンベロープとピッチエンベロープなど、
定義毎にバンクを割り振ります。

**** スラーについて
　ex版でのスラーは、キーオフ、エフェクトテーブルの初期化をせずに、
次のノートに進む機能です。発音周波数のみが変更されます。

**** 使い方

    1. ppmck release 9aをこのパッケージにあるファイルで置き換える
    2. mmlでスラー(&)を使って楽しむ。


 @v0 = { 15,14,13,10,6,5 }
 A o4 @v0 @2
 A c c&g g


とすると効果を確認できます。

また、

 A SM cdefg SMOF

とすると、SMからSMOFまでがスムースな発音になります。


    3.ポルタメントもどきを使う

  A c PS g PS c

などとすると、ピッチの上下を楽しむことができます。
ただし、PSコマンド後の音程は正確ではありませんので、
正確な音程を望むにはノートによる再発音が必要になります。


    4.ハードウェアエンベロープ

EHコマンド
指定の後、必ずduty設定を行うこと（有効にならない)
ボリューム設定でエンベロープのディケイレートを指定できる
EHx,y

x : 1でエンベロープを有効に
y : 0でエンベロープのループ

例:

 A EH1,1 @4 cdefgab>c



**** 履歴

2007/05/02 release 9+

2007/05/03 release 9++ 

スラーの解釈を間違えていたという問題を修正（根本的）

2007/05/04 release 9 ex

コンパイラにSM,SMOFコマンド、スラーコマンド後のノートチェックを追加

2007/05/12 release 9 ex2

PSコマンドの追加

2008/03/19 release 9 ex3

2A03ハードウェアエンベロープの追加

2009/05/13 release 9 ex3.5

当ファイルを改訂
DPCMトラックでスラーコマンドを無視するようにした

2009/05/13 release 9 ex4

DPCMでスラーコマンド後の最初のノートを発音しないようにした
当ファイルの訂正（スラーの有効トラックが異なった）
ppmckcのトラック有効フラグを調節
MMC5に対してスラーコマンドを有効にした

2009/10/20 release 9 ex5

ハードウェアエンベロープ(EH)をノイズトラック、MMC5でも利用可能にした。

2009/11/28 release 9 ex5.1

nesasmのバグ修正。srcディレクトリ内Makefileの調節。
sounddrv.hの長過ぎるラベルを32文字以内に修正。

2010/01/01 release 9a ex1

release 9aの主な変更点であるppmck.asmをマージした。

2010/03/05 release 9a ex2

mmc5のハードウェアエンベロープ機能を修正。
スラーが未対応のトラックではタイになるよう修正。

2012/12/25 release 9a ex3

実機再生の為にFDS初期化の追加。
 
2013/03/24 release 9a ex4

定義データが一定以上ある場合(1024バイト以上)、新しいバンクを利用するようにした。

2013/04/30 release 9a ex5

VRC7音色定義に@OTを追加、フォーマットはMGSDRVの音色定義に準拠。

2013/05/08 release 9a ex5.1

コマンドライン系ソースコードと文章の文字コードをSJISからUTF-8に変更。
（win32コンソール向けにはgccオプションで内部的にSJISに変換）
nesasmのソースコードの調整。

2013/06/26 release 9a ex5.2

nes_include以下のソースコードをUTF-8に変更した。
スラーを同一音階で使用する際に音長を長くするようにした。
VRC7の周波数テーブルを1/2に設定、エンベロープ等使用時のノイズを減少。

2013/07/10 release 9a ex5.3

NSF再生時の過負荷の検出と抑制を実装した。

